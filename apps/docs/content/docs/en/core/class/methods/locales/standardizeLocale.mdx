---
title: standardizeLocale()
description: API Reference for the GT standardizeLocale method
---

## Overview

The `standardizeLocale()` method standardizes a BCP-47 locale code to ensure correct formatting and casing. It converts locale codes to their proper canonical format, making them suitable for use with internationalization APIs and ensuring consistency across your application.

```typescript
const gt = new GT({
  sourceLocale: 'en',
  targetLocale: 'es-ES'
});

// Standardize various locale formats
console.log(gt.standardizeLocale('en_us')); // "en-US"
console.log(gt.standardizeLocale('zh_cn')); // "zh-CN"
console.log(gt.standardizeLocale('EN-gb')); // "en-GB"
console.log(gt.standardizeLocale('fr-ca')); // "fr-CA"

// Already standardized locales pass through unchanged
console.log(gt.standardizeLocale('es-ES')); // "es-ES"
console.log(gt.standardizeLocale('ja-JP')); // "ja-JP"
```

This method is essential for normalizing locale codes from various sources (user input, configuration files, APIs) to ensure consistency and compatibility with internationalization standards.

<Callout>
**Locale Normalization:**
Always standardize locale codes before validation or API calls. This method handles common formatting variations like underscores vs hyphens and incorrect casing, ensuring your locale codes follow BCP-47 conventions.
</Callout>

---

## Reference

### Parameters

<TypeTable
  type={{
    "locale?": {
      type: 'string',
      optional: true,
      default: 'this.targetLocale'
    }
  }}
/>

### Parameters Description

| Parameter | Description |
|-----------|-------------|
| `locale` | The BCP-47 locale code to standardize. If not provided, uses the instance's `targetLocale` |

### Returns

`string` - The standardized BCP-47 locale code, or empty string if the input is invalid

### Throws

- `Error` - If no locale is provided and the instance has no `targetLocale` configured

---

## Behavior

### Standardization Process

The method performs the following standardization steps:
1. **Replace underscores** - Converts underscores (`_`) to hyphens (`-`)
2. **Normalize casing** - Language codes to lowercase, region codes to uppercase
3. **Validate format** - Ensures the result follows BCP-47 conventions
4. **Return result** - Returns the standardized locale or empty string if invalid

### Format Corrections

Common format corrections applied:
- `en_US` → `en-US` (underscore to hyphen)
- `zh_cn` → `zh-CN` (underscore to hyphen, casing)
- `EN-gb` → `en-GB` (language lowercase, region uppercase)
- `Fr-ca` → `fr-CA` (proper casing throughout)
- `ja_jp` → `ja-JP` (underscore and casing)

### Validation

The method includes basic validation:
- Returns empty string for completely invalid input
- Handles malformed locale codes gracefully
- Preserves valid locale extensions and variants when present

---

## Examples

### Basic Standardization

```typescript
const gt = new GT({
  sourceLocale: 'en-US',
  targetLocale: 'es-ES'
});

// Common underscore formats
console.log(gt.standardizeLocale('en_us')); // "en-US"
console.log(gt.standardizeLocale('es_es')); // "es-ES"
console.log(gt.standardizeLocale('zh_cn')); // "zh-CN"
console.log(gt.standardizeLocale('ja_jp')); // "ja-JP"

// Mixed casing corrections
console.log(gt.standardizeLocale('EN-gb')); // "en-GB"
console.log(gt.standardizeLocale('Fr-CA')); // "fr-CA"
console.log(gt.standardizeLocale('DE-de')); // "de-DE"
console.log(gt.standardizeLocale('pt-br')); // "pt-BR"

// Already standardized (no change)
console.log(gt.standardizeLocale('ar-SA')); // "ar-SA"
console.log(gt.standardizeLocale('ko-KR')); // "ko-KR"
```

### User Input Normalization

```typescript
// Example: Processing user input from form fields
const gt = new GT({ sourceLocale: 'en-US' });

function processUserLocaleInput(rawInput: string): {
  original: string;
  standardized: string;
  isValid: boolean;
  errorMessage?: string;
} {
  try {
    const standardized = gt.standardizeLocale(rawInput.trim());
    const isValid = standardized !== '' && gt.isValidLocale(standardized);
    
    return {
      original: rawInput,
      standardized,
      isValid,
      errorMessage: !isValid ? 'Invalid locale format' : undefined
    };
  } catch (error) {
    return {
      original: rawInput,
      standardized: '',
      isValid: false,
      errorMessage: error.message
    };
  }
}

// Simulate user inputs
const userInputs = [
  'en_us',       // Valid, needs standardization
  'zh_CN',       // Valid, needs standardization  
  'FR-ca',       // Valid, needs standardization
  'es-ES',       // Already standardized
  'invalid',     // Invalid locale
  '',            // Empty input
  'en-US-variant' // Extended locale
];

userInputs.forEach(input => {
  const result = processUserLocaleInput(input);
  console.log(`Input: "${input}" → "${result.standardized}" (${result.isValid ? 'valid' : 'invalid'})`);
});

// Output:
// Input: "en_us" → "en-US" (valid)
// Input: "zh_CN" → "zh-CN" (valid)
// Input: "FR-ca" → "fr-CA" (valid)
// Input: "es-ES" → "es-ES" (valid)
// Input: "invalid" → "" (invalid)
// Input: "" → "" (invalid)
```

### Configuration File Processing

```typescript
interface LocaleConfig {
  primary: string;
  fallbacks: string[];
  supported: string[];
}

// Example: Processing locale configuration from JSON
const rawConfig: LocaleConfig = {
  primary: 'en_us',
  fallbacks: ['en_gb', 'en'],
  supported: ['en_us', 'es_es', 'fr_ca', 'zh_cn', 'ja_jp']
};

function standardizeLocaleConfig(config: LocaleConfig, gt: GT): LocaleConfig {
  return {
    primary: gt.standardizeLocale(config.primary),
    fallbacks: config.fallbacks
      .map(locale => gt.standardizeLocale(locale))
      .filter(locale => locale !== ''), // Remove invalid locales
    supported: config.supported
      .map(locale => gt.standardizeLocale(locale))
      .filter(locale => locale !== '')
  };
}

const gt = new GT({ sourceLocale: 'en-US' });
const standardizedConfig = standardizeLocaleConfig(rawConfig, gt);

console.log('Standardized config:', standardizedConfig);
// {
//   primary: 'en-US',
//   fallbacks: ['en-GB', 'en'],
//   supported: ['en-US', 'es-ES', 'fr-CA', 'zh-CN', 'ja-JP']
// }
```

### API Response Processing

```typescript
// Example: Standardizing locale codes from external APIs
interface ApiLocaleResponse {
  locale_code: string;
  display_name: string;
  is_rtl: boolean;
}

function processApiLocales(responses: ApiLocaleResponse[], gt: GT) {
  return responses.map(response => {
    const standardizedLocale = gt.standardizeLocale(response.locale_code);
    const isValidLocale = standardizedLocale !== '' && gt.isValidLocale(standardizedLocale);
    
    return {
      ...response,
      locale_code: standardizedLocale,
      original_locale_code: response.locale_code,
      is_valid: isValidLocale,
      needs_standardization: standardizedLocale !== response.locale_code
    };
  }).filter(response => response.is_valid); // Only keep valid locales
}

// Mock API responses with various formats
const apiResponses: ApiLocaleResponse[] = [
  { locale_code: 'en_us', display_name: 'English (US)', is_rtl: false },
  { locale_code: 'es_ES', display_name: 'Spanish (Spain)', is_rtl: false },
  { locale_code: 'ar-SA', display_name: 'Arabic (Saudi Arabia)', is_rtl: true },
  { locale_code: 'zh_cn', display_name: 'Chinese (China)', is_rtl: false },
  { locale_code: 'INVALID', display_name: 'Invalid Locale', is_rtl: false }
];

const gt = new GT({ sourceLocale: 'en-US' });
const processedResponses = processApiLocales(apiResponses, gt);

console.log('Processed API responses:', processedResponses);
// Only valid, standardized locales will be included
```

### Default Target Locale Standardization

```typescript
const gt = new GT({
  targetLocale: 'zh_cn' // Non-standardized target locale
});

// Standardize the default target locale
const standardizedTarget = gt.standardizeLocale(); // Uses targetLocale
console.log('Standardized target:', standardizedTarget); // "zh-CN"

// Compare with original
console.log('Original target:', gt.targetLocale); // "zh_cn"
console.log('Needs standardization:', standardizedTarget !== gt.targetLocale); // true
```

---

## Error Handling

### Missing Target Locale

```typescript
const gt = new GT(); // No target locale configured

try {
  // No parameter and no target locale
  const result = gt.standardizeLocale();
} catch (error) {
  console.error('Standardization failed:', error.message);
  // Error: No target locale provided for standardizeLocale
}
```

### Invalid Locale Handling

```typescript
const gt = new GT({ targetLocale: 'en-US' });

// Invalid locales return empty string
console.log(gt.standardizeLocale('invalid-locale')); // ""
console.log(gt.standardizeLocale('xyz123')); // ""
console.log(gt.standardizeLocale('')); // ""

// Safe standardization with fallbacks
function safeStandardizeLocale(
  gt: GT, 
  locale?: string,
  fallback: string = 'en-US'
): { standardized: string; wasStandardized: boolean; isValid: boolean } {
  try {
    if (!locale) {
      if (!gt.targetLocale) {
        return {
          standardized: fallback,
          wasStandardized: false,
          isValid: gt.isValidLocale(fallback)
        };
      }
      locale = gt.targetLocale;
    }
    
    const standardized = gt.standardizeLocale(locale);
    
    if (standardized === '') {
      return {
        standardized: fallback,
        wasStandardized: false,
        isValid: gt.isValidLocale(fallback)
      };
    }
    
    return {
      standardized,
      wasStandardized: standardized !== locale,
      isValid: gt.isValidLocale(standardized)
    };
  } catch (error) {
    console.warn(`Standardization failed for ${locale}:`, error.message);
    return {
      standardized: fallback,
      wasStandardized: false,
      isValid: gt.isValidLocale(fallback)
    };
  }
}

// Usage
const results = [
  safeStandardizeLocale(gt, 'en_us'),
  safeStandardizeLocale(gt, 'invalid'),
  safeStandardizeLocale(gt, ''),
  safeStandardizeLocale(gt, undefined)
];

console.log('Safe standardization results:', results);
```

### Batch Processing with Error Handling

```typescript
function batchStandardizeLocales(
  gt: GT, 
  locales: string[]
): Array<{ original: string; standardized: string; success: boolean; error?: string }> {
  return locales.map(locale => {
    try {
      const standardized = gt.standardizeLocale(locale);
      return {
        original: locale,
        standardized: standardized || locale, // Keep original if standardization fails
        success: standardized !== ''
      };
    } catch (error) {
      return {
        original: locale,
        standardized: locale,
        success: false,
        error: error.message
      };
    }
  });
}

// Usage with mixed valid/invalid inputs
const mixedLocales = ['en_us', 'es-ES', 'invalid', 'zh_cn', '', 'fr_CA'];
const results = batchStandardizeLocales(gt, mixedLocales);

console.log('Batch results:');
results.forEach(result => {
  const status = result.success ? '✓' : '✗';
  console.log(`${status} "${result.original}" → "${result.standardized}"`);
  if (result.error) {
    console.log(`   Error: ${result.error}`);
  }
});
```

---

## Integration Patterns

### Validation Pipeline

```typescript
class LocaleValidator {
  constructor(private gt: GT) {}
  
  validateAndStandardize(locale: string): {
    original: string;
    standardized: string;
    isValid: boolean;
    steps: string[];
  } {
    const steps: string[] = [];
    let current = locale;
    
    steps.push(`Input: "${current}"`);
    
    // Step 1: Standardize
    try {
      const standardized = this.gt.standardizeLocale(current);
      if (standardized !== current) {
        steps.push(`Standardized: "${current}" → "${standardized}"`);
        current = standardized;
      } else {
        steps.push('No standardization needed');
      }
      
      if (current === '') {
        steps.push('Standardization failed - invalid format');
        return {
          original: locale,
          standardized: current,
          isValid: false,
          steps
        };
      }
    } catch (error) {
      steps.push(`Standardization error: ${error.message}`);
      return {
        original: locale,
        standardized: locale,
        isValid: false,
        steps
      };
    }
    
    // Step 2: Validate
    const isValid = this.gt.isValidLocale(current);
    steps.push(`Validation: ${isValid ? 'passed' : 'failed'}`);
    
    return {
      original: locale,
      standardized: current,
      isValid,
      steps
    };
  }
}

// Usage
const gt = new GT({ sourceLocale: 'en-US' });
const validator = new LocaleValidator(gt);

const testLocales = ['en_us', 'zh_CN', 'invalid', 'ar-SA'];
testLocales.forEach(locale => {
  const result = validator.validateAndStandardize(locale);
  console.log(`\nProcessing "${locale}":`);
  result.steps.forEach(step => console.log(`  ${step}`));
  console.log(`Result: ${result.isValid ? 'VALID' : 'INVALID'} → "${result.standardized}"`);
});
```

### Configuration Migration

```typescript
// Example: Migrating old locale configuration to standardized format
interface LegacyLocaleConfig {
  default_locale: string;
  supported_locales: string[];
  fallback_chain: Record<string, string[]>;
}

interface ModernLocaleConfig {
  defaultLocale: string;
  supportedLocales: string[];
  fallbackChain: Record<string, string[]>;
  migrationLog: string[];
}

function migrateLocaleConfig(
  legacy: LegacyLocaleConfig, 
  gt: GT
): ModernLocaleConfig {
  const migrationLog: string[] = [];
  
  // Standardize default locale
  const defaultLocale = gt.standardizeLocale(legacy.default_locale);
  if (defaultLocale !== legacy.default_locale) {
    migrationLog.push(`Default locale: "${legacy.default_locale}" → "${defaultLocale}"`);
  }
  
  // Standardize supported locales
  const supportedLocales = legacy.supported_locales
    .map(locale => {
      const standardized = gt.standardizeLocale(locale);
      if (standardized !== locale) {
        migrationLog.push(`Supported locale: "${locale}" → "${standardized}"`);
      }
      return standardized;
    })
    .filter(locale => locale !== ''); // Remove invalid locales
  
  // Standardize fallback chains
  const fallbackChain: Record<string, string[]> = {};
  for (const [key, fallbacks] of Object.entries(legacy.fallback_chain)) {
    const standardizedKey = gt.standardizeLocale(key);
    const standardizedFallbacks = fallbacks
      .map(locale => gt.standardizeLocale(locale))
      .filter(locale => locale !== '');
    
    if (standardizedKey !== '') {
      fallbackChain[standardizedKey] = standardizedFallbacks;
      if (standardizedKey !== key) {
        migrationLog.push(`Fallback key: "${key}" → "${standardizedKey}"`);
      }
    }
  }
  
  return {
    defaultLocale,
    supportedLocales,
    fallbackChain,
    migrationLog
  };
}

// Example usage
const legacyConfig: LegacyLocaleConfig = {
  default_locale: 'en_us',
  supported_locales: ['en_us', 'es_es', 'zh_cn', 'ja_jp'],
  fallback_chain: {
    'zh_cn': ['zh_tw', 'zh', 'en_us'],
    'es_mx': ['es_es', 'es', 'en_us']
  }
};

const gt = new GT({ sourceLocale: 'en-US' });
const modernConfig = migrateLocaleConfig(legacyConfig, gt);

console.log('Migration completed:');
console.log('Modern config:', modernConfig);
console.log('\nMigration log:');
modernConfig.migrationLog.forEach(log => console.log(`  ${log}`));
```

---

## Performance Considerations

- **Lightweight Operation**: Simple string manipulation with minimal overhead
- **No Caching**: Each call performs fresh standardization - consider caching for frequent operations
- **RegExp Performance**: Uses regular expressions for pattern matching
- **Memory Efficient**: No internal state or memory allocation

```typescript
// Performance optimization for high-frequency standardization
class StandardizationCache {
  private cache = new Map<string, string>();
  
  constructor(private gt: GT) {}
  
  standardize(locale: string): string {
    if (!this.cache.has(locale)) {
      this.cache.set(locale, this.gt.standardizeLocale(locale));
    }
    return this.cache.get(locale)!;
  }
  
  preload(locales: string[]): void {
    locales.forEach(locale => this.standardize(locale));
  }
  
  clear(): void {
    this.cache.clear();
  }
  
  getStats(): { size: number; hitRate: number } {
    // Implementation would track hits/misses
    return { size: this.cache.size, hitRate: 0 };
  }
}

// Usage
const gt = new GT({ sourceLocale: 'en-US' });
const cache = new StandardizationCache(gt);

// Preload common non-standard formats
cache.preload(['en_us', 'es_es', 'zh_cn', 'fr_ca']);

// Fast repeated standardization
console.log(cache.standardize('en_us')); // Fast - cached
console.log(cache.standardize('new_locale')); // Slower - first time
```

---

## Notes

- Converts underscores to hyphens and normalizes casing
- Returns empty string for invalid locale codes
- Essential for normalizing locale input from various sources
- Follows BCP-47 locale code conventions
- Does not validate locale existence, only format
- Language codes become lowercase, region codes become uppercase
- Preserves locale extensions and variants when present
- Performance optimized for common standardization patterns

## Next Steps

- **[Validate standardized locales with isValidLocale()](/docs/core/class/methods/locales/isValidLocale)**
- **[Resolve canonical locales with resolveCanonicalLocale()](/docs/core/class/methods/locales/resolveCanonicalLocale)**
- **[Get locale properties with getLocaleProperties()](/docs/core/class/methods/locales/getLocaleProperties)**
- **[Explore standalone standardizeLocale()](/docs/core/functions/locales/standardizeLocale)**